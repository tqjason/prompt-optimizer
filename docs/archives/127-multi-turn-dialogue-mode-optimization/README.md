# 127 - å¤šè½®å¯¹è¯æ¨¡å¼ï¼ˆPro-System / Conversationï¼‰ä¼˜åŒ–è®¾è®¡

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

å½’æ¡£å¤šè½®å¯¹è¯æ¨¡å¼ï¼ˆåŸâ€œä¸Šä¸‹æ–‡-ç³»ç»Ÿâ€ï¼‰çš„ä¼˜åŒ–äº¤äº’ä¸æ•°æ®ç»“æ„è®¾è®¡ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯æ”¯æŒåœ¨ä¼šè¯ä¸­é€‰æ‹©ä»»æ„ `system/user` æ¶ˆæ¯è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶ä»¥â€œæ¶ˆæ¯ IDâ€ä¸ºç¨³å®šé”šç‚¹ç®¡ç†ç‰ˆæœ¬é“¾è·¯ä¸è‡ªåŠ¨åº”ç”¨ã€‚

## â±ï¸ æ—¶é—´çº¿

- **å¼€å§‹æ—¶é—´**: 2025-01-04
- **æœ€åæ›´æ–°**: 2025-01-05
- **çŠ¶æ€**: âœ… è®¾è®¡æ–¹æ¡ˆ + å®æ–½è®°å½•ï¼ˆä»¥ v3.1 ä¸ºåŸºçº¿ï¼‰

## ğŸ¯ æ ¸å¿ƒè¦ç‚¹

- **ç¨³å®šé€‰æ‹©**ï¼šä»¥ `ConversationMessage.id` ä½œä¸ºé€‰æ‹©ä¸æ˜ å°„çš„ä¸»é”®ï¼Œé¿å…æŒ‰ç´¢å¼•å¯¼è‡´çš„æ’å…¥/åˆ é™¤/æ’åºé—®é¢˜ã€‚
- **å·¥ä½œé“¾å¤ç”¨**ï¼šé€šè¿‡ `messageChainMap`ï¼ˆæ¶ˆæ¯ID â†’ chainIdï¼‰å®ç°â€œåˆ‡æ¢æ¶ˆæ¯æ—¶è‡ªåŠ¨åŠ è½½æ—¢æœ‰é“¾â€çš„ä½“éªŒã€‚
- **è‡ªåŠ¨åº”ç”¨ä¸è‡ªåŠ¨ä¿å­˜**ï¼šä¼˜åŒ–ç»“æœè‡ªåŠ¨åº”ç”¨åˆ°ä¼šè¯æ¶ˆæ¯ï¼Œå·¥ä½œé“¾ä¾èµ–å†å²è®°å½•ç³»ç»Ÿè‡ªåŠ¨ä¿å­˜ï¼ˆæ— éœ€é¢å¤–æŒä¹…åŒ–ç´¢å¼•ï¼‰ã€‚

## ğŸ“ æ–‡æ¡£æ¸…å•

- [x] `design.md` - è®¾è®¡æ–¹æ¡ˆä¸å®æ–½è®°å½•ï¼ˆæœ€ç»ˆç‰ˆ v3.1ï¼‰

## ğŸ”— ç›¸å…³å®ç°å‚è€ƒï¼ˆä»£ç ï¼‰

- `packages/core/src/services/prompt/types.ts`ï¼ˆ`ConversationMessage.id` / `originalContent?`ï¼‰
- `packages/ui/src/composables/prompt/useConversationOptimization.ts`ï¼ˆ`selectedMessageId` / `messageChainMap` / è‡ªåŠ¨åº”ç”¨ï¼‰
- `packages/ui/src/components/context-mode/ContextSystemWorkspace.vue`ï¼ˆå¤šè½®å¯¹è¯æ¨¡å¼å·¥ä½œåŒºï¼‰
- `packages/ui/src/components/context-mode/ConversationManager.vue`ï¼ˆä¼šè¯è¾“å…¥ä¸æ¶ˆæ¯é€‰æ‹©ï¼‰

